import{A as Me,B as xe,C as le,D as ze,s as J,r as G,f as O,a as D,g as $,h as T,d as f,c as F,j as y,i as b,x as N,u as M,v as x,w as z,E as R,F as X,G as ne,H,I as He,J as re,K as Je,e as K,y as E,L as ue,p as pe,l as Z,m as ee,M as _e,N as Qe,n as be,O as we,z as Ye,P as me,Q as Xe}from"../chunks/scheduler.66fad464.js";import{g as ie,t as g,c as oe,a as p,S as Q,i as Y,b as j,d as q,m as L,e as U,f as ye}from"../chunks/index.2ed8ae8a.js";import{j as Ze,w as et,k as tt}from"../chunks/singletons.24583d20.js";function ke(r,e){const t=e.token={};function s(n,i,o,l){if(e.token!==t)return;e.resolved=l;let a=e.ctx;o!==void 0&&(a=a.slice(),a[o]=l);const c=n&&(e.current=n)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((h,_)=>{_!==i&&h&&(ie(),g(h,1,1,()=>{e.blocks[_]===h&&(e.blocks[_]=null)}),oe())}):e.block.d(1),c.c(),p(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[i]=c),u&&ze()}if(Me(r)){const n=xe();if(r.then(i=>{le(n),s(e.then,1,e.value,i),le(null)},i=>{if(le(n),s(e.catch,2,e.error,i),le(null),!e.hasCatch)throw i}),e.current!==e.pending)return s(e.pending,0),!0}else{if(e.current!==e.then)return s(e.then,1,e.value,r),!0;e.resolved=r}}function st(r,e,t){const s=e.slice(),{resolved:n}=r;r.current===r.then&&(s[r.value]=n),r.current===r.catch&&(s[r.error]=n),r.block.p(s,t)}function Se(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function de(r,e){const t={},s={},n={$$scope:1};let i=r.length;for(;i--;){const o=r[i],l=e[i];if(l){for(const a in o)a in l||(s[a]=1);for(const a in l)n[a]||(t[a]=l[a],n[a]=1);r[i]=l}else for(const a in o)n[a]=1}for(const o in s)o in t||(t[o]=void 0);return t}const nt=r=>({}),Ce=r=>({}),it=r=>({}),Oe=r=>({}),ot=r=>({}),$e=r=>({});function rt(r){let e,t,s,n,i,o,l;const a=r[1].start,c=G(a,r,r[0],$e),u=r[1].middle,h=G(u,r,r[0],Oe),_=r[1].end,m=G(_,r,r[0],Ce);return{c(){e=O("div"),t=O("div"),c&&c.c(),s=D(),n=O("div"),h&&h.c(),i=D(),o=O("div"),m&&m.c(),this.h()},l(d){e=$(d,"DIV",{class:!0});var w=T(e);t=$(w,"DIV",{class:!0});var S=T(t);c&&c.l(S),S.forEach(f),s=F(w),n=$(w,"DIV",{class:!0});var k=T(n);h&&h.l(k),k.forEach(f),i=F(w),o=$(w,"DIV",{class:!0});var B=T(o);m&&m.l(B),B.forEach(f),w.forEach(f),this.h()},h(){y(t,"class","flex flex-row gap-2 items-center"),y(n,"class","flex flex-row gap-2 items-center"),y(o,"class","flex flex-row gap-2 items-center"),y(e,"class","max-h-8 p-2 flex flex-row justify-between outline outline-2 outline-slate-300 dark:outline-slate-700 ")},m(d,w){b(d,e,w),N(e,t),c&&c.m(t,null),N(e,s),N(e,n),h&&h.m(n,null),N(e,i),N(e,o),m&&m.m(o,null),l=!0},p(d,[w]){c&&c.p&&(!l||w&1)&&M(c,a,d,d[0],l?z(a,d[0],w,ot):x(d[0]),$e),h&&h.p&&(!l||w&1)&&M(h,u,d,d[0],l?z(u,d[0],w,it):x(d[0]),Oe),m&&m.p&&(!l||w&1)&&M(m,_,d,d[0],l?z(_,d[0],w,nt):x(d[0]),Ce)},i(d){l||(p(c,d),p(h,d),p(m,d),l=!0)},o(d){g(c,d),g(h,d),g(m,d),l=!1},d(d){d&&f(e),c&&c.d(d),h&&h.d(d),m&&m.d(d)}}}function lt(r,e,t){let{$$slots:s={},$$scope:n}=e;return r.$$set=i=>{"$$scope"in i&&t(0,n=i.$$scope)},[n,s]}class at extends Q{constructor(e){super(),Y(this,e,lt,rt,J,{})}}function ct(r){let e,t;const s=r[1].default,n=G(s,r,r[0],null);return{c(){e=O("div"),n&&n.c(),this.h()},l(i){e=$(i,"DIV",{class:!0});var o=T(e);n&&n.l(o),o.forEach(f),this.h()},h(){y(e,"class","flex flex-col grow justify-center items-center gap-2")},m(i,o){b(i,e,o),n&&n.m(e,null),t=!0},p(i,[o]){n&&n.p&&(!t||o&1)&&M(n,s,i,i[0],t?z(s,i[0],o,null):x(i[0]),null)},i(i){t||(p(n,i),t=!0)},o(i){g(n,i),t=!1},d(i){i&&f(e),n&&n.d(i)}}}function ut(r,e,t){let{$$slots:s={},$$scope:n}=e;return r.$$set=i=>{"$$scope"in i&&t(0,n=i.$$scope)},[n,s]}class Fe extends Q{constructor(e){super(),Y(this,e,ut,ct,J,{})}}function dt(r){let e,t,s;const n=r[4].default,i=G(n,r,r[3],null);let o=[{class:t="text-cyan-500 hover:text-cyan-600 active:text-cyan-700 "+r[1]},{href:r[0]},r[2]],l={};for(let a=0;a<o.length;a+=1)l=R(l,o[a]);return{c(){e=O("a"),i&&i.c(),this.h()},l(a){e=$(a,"A",{class:!0,href:!0});var c=T(e);i&&i.l(c),c.forEach(f),this.h()},h(){X(e,l)},m(a,c){b(a,e,c),i&&i.m(e,null),s=!0},p(a,[c]){i&&i.p&&(!s||c&8)&&M(i,n,a,a[3],s?z(n,a[3],c,null):x(a[3]),null),X(e,l=de(o,[(!s||c&2&&t!==(t="text-cyan-500 hover:text-cyan-600 active:text-cyan-700 "+a[1]))&&{class:t},(!s||c&1)&&{href:a[0]},c&4&&a[2]]))},i(a){s||(p(i,a),s=!0)},o(a){g(i,a),s=!1},d(a){a&&f(e),i&&i.d(a)}}}function ht(r,e,t){let s;const n=["href"];let i=ne(e,n),{$$slots:o={},$$scope:l}=e,{href:a=""}=e;return r.$$set=c=>{t(5,e=R(R({},e),H(c))),t(2,i=ne(e,n)),"href"in c&&t(0,a=c.href),"$$scope"in c&&t(3,l=c.$$scope)},r.$$.update=()=>{t(1,s=e.class??"")},e=H(e),[a,s,i,l,o]}class Ke extends Q{constructor(e){super(),Y(this,e,ht,dt,J,{href:0})}}const ft=r=>({}),Pe=r=>({}),pt=r=>({}),Te=r=>({});function Ie(r){let e,t;const s=r[5].subtitle,n=G(s,r,r[4],Pe);return{c(){e=O("div"),n&&n.c(),this.h()},l(i){e=$(i,"DIV",{class:!0});var o=T(e);n&&n.l(o),o.forEach(f),this.h()},h(){y(e,"class","flex flex-col items-center overflow-x-auto")},m(i,o){b(i,e,o),n&&n.m(e,null),t=!0},p(i,o){n&&n.p&&(!t||o&16)&&M(n,s,i,i[4],t?z(s,i[4],o,ft):x(i[4]),Pe)},i(i){t||(p(n,i),t=!0)},o(i){g(n,i),t=!1},d(i){i&&f(e),n&&n.d(i)}}}function mt(r){let e,t,s,n,i;const o=r[5].image,l=G(o,r,r[4],Te);let a=r[2].subtitle&&Ie(r);return{c(){e=O("div"),t=O("div"),l&&l.c(),s=D(),a&&a.c(),this.h()},l(c){e=$(c,"DIV",{class:!0});var u=T(e);t=$(u,"DIV",{class:!0});var h=T(t);l&&l.l(h),h.forEach(f),s=F(u),a&&a.l(u),u.forEach(f),this.h()},h(){y(t,"class","flex grow justify-center items-center overflow-hidden"),y(e,"class",n="flex flex-col p-2 gap-2 rounded-2xl shadow-lg bg-slate-100 dark:bg-slate-900 dark:shadow-none dark:outline dark:outline-2 dark:outline-cyan-900 "+r[1]+" "+r[0])},m(c,u){b(c,e,u),N(e,t),l&&l.m(t,null),N(e,s),a&&a.m(e,null),i=!0},p(c,[u]){l&&l.p&&(!i||u&16)&&M(l,o,c,c[4],i?z(o,c[4],u,pt):x(c[4]),Te),c[2].subtitle?a?(a.p(c,u),u&4&&p(a,1)):(a=Ie(c),a.c(),p(a,1),a.m(e,null)):a&&(ie(),g(a,1,1,()=>{a=null}),oe()),(!i||u&3&&n!==(n="flex flex-col p-2 gap-2 rounded-2xl shadow-lg bg-slate-100 dark:bg-slate-900 dark:shadow-none dark:outline dark:outline-2 dark:outline-cyan-900 "+c[1]+" "+c[0]))&&y(e,"class",n)},i(c){i||(p(l,c),p(a),i=!0)},o(c){g(l,c),g(a),i=!1},d(c){c&&f(e),l&&l.d(c),a&&a.d()}}}function bt(r,e,t){let s,n,{$$slots:i={},$$scope:o}=e;const l=He(i);let{size:a="md"}=e;return r.$$set=c=>{t(6,e=R(R({},e),H(c))),"size"in c&&t(3,a=c.size),"$$scope"in c&&t(4,o=c.$$scope)},r.$$.update=()=>{r.$$.dirty&8&&t(1,s={sm:"w-24 h-24",md:"w-48 h-48",lg:"w-96 h-96"}[a]??"w-48 h-48"),t(0,n=e.class)},e=H(e),[n,s,l,a,o,i]}class gt extends Q{constructor(e){super(),Y(this,e,bt,mt,J,{size:3})}}function vt(r){let e,t,s;const n=r[2].default,i=G(n,r,r[1],null);return{c(){e=O("div"),i&&i.c(),this.h()},l(o){e=$(o,"DIV",{class:!0});var l=T(e);i&&i.l(l),l.forEach(f),this.h()},h(){y(e,"class",t="flex flex-row flex-wrap justify-center items-start gap-4 "+r[0])},m(o,l){b(o,e,l),i&&i.m(e,null),s=!0},p(o,[l]){i&&i.p&&(!s||l&2)&&M(i,n,o,o[1],s?z(n,o[1],l,null):x(o[1]),null),(!s||l&1&&t!==(t="flex flex-row flex-wrap justify-center items-start gap-4 "+o[0]))&&y(e,"class",t)},i(o){s||(p(i,o),s=!0)},o(o){g(i,o),s=!1},d(o){o&&f(e),i&&i.d(o)}}}function _t(r,e,t){let s,{$$slots:n={},$$scope:i}=e;return r.$$set=o=>{t(3,e=R(R({},e),H(o))),"$$scope"in o&&t(1,i=o.$$scope)},r.$$.update=()=>{t(0,s=e.class)},e=H(e),[s,i,n]}class wt extends Q{constructor(e){super(),Y(this,e,_t,vt,J,{})}}const yt=Ze("goto");function kt(r){let e,t,s,n,i;const o=r[7].default,l=G(o,r,r[6],null);let a=[{class:t="px-2 border-4 rounded-2xl "+r[1]+" "+r[0]},r[3]],c={};for(let u=0;u<a.length;u+=1)c=R(c,a[u]);return{c(){e=O("button"),l&&l.c(),this.h()},l(u){e=$(u,"BUTTON",{class:!0});var h=T(e);l&&l.l(h),h.forEach(f),this.h()},h(){X(e,c)},m(u,h){b(u,e,h),l&&l.m(e,null),e.autofocus&&e.focus(),s=!0,n||(i=re(e,"click",r[2]),n=!0)},p(u,[h]){l&&l.p&&(!s||h&64)&&M(l,o,u,u[6],s?z(o,u[6],h,null):x(u[6]),null),X(e,c=de(a,[(!s||h&3&&t!==(t="px-2 border-4 rounded-2xl "+u[1]+" "+u[0]))&&{class:t},h&8&&u[3]]))},i(u){s||(p(l,u),s=!0)},o(u){g(l,u),s=!1},d(u){u&&f(e),l&&l.d(u),n=!1,i()}}}function St(r,e,t){let s,n;const i=["href","secondary"];let o=ne(e,i),{$$slots:l={},$$scope:a}=e,{href:c=null}=e,{secondary:u=!1}=e;const h=Je();async function _(m){h("click",m,{cancelable:!0})&&c&&await yt(c)}return r.$$set=m=>{t(9,e=R(R({},e),H(m))),t(3,o=ne(e,i)),"href"in m&&t(4,c=m.href),"secondary"in m&&t(5,u=m.secondary),"$$scope"in m&&t(6,a=m.$$scope)},r.$$.update=()=>{r.$$.dirty&32&&t(1,s=u?`
			text-white
			bg-teal-500
			border-teal-400
			hover:bg-teal-600
			hover:border-teal-500
			active:bg-teal-700
			active:border-teal-600
			disabled:bg-teal-200
			disabled:text-teal-700
			disabled:border-teal-300
			`:`
			text-white
			bg-cyan-500
			border-cyan-400
			hover:bg-cyan-600
			hover:border-cyan-500
			active:bg-cyan-700
			active:border-cyan-600
			disabled:bg-cyan-200
			disabled:text-cyan-700
			disabled:border-cyan-300
			`),t(0,n=e.class??"")},e=H(e),[n,s,_,o,c,u,a,l]}class ge extends Q{constructor(e){super(),Y(this,e,St,kt,J,{href:4,secondary:5})}}function Ct(r){let e,t,s,n=[{type:"text"},{class:r[2]},r[3]],i={};for(let o=0;o<n.length;o+=1)i=R(i,n[o]);return{c(){e=O("input"),this.h()},l(o){e=$(o,"INPUT",{type:!0,class:!0}),this.h()},h(){X(e,i)},m(o,l){b(o,e,l),e.autofocus&&e.focus(),ue(e,r[0]),t||(s=re(e,"input",r[5]),t=!0)},p(o,l){X(e,i=de(n,[{type:"text"},{class:o[2]},l&8&&o[3]])),l&1&&e.value!==o[0]&&ue(e,o[0])},d(o){o&&f(e),t=!1,s()}}}function Ot(r){let e,t,s,n=[{type:"password"},{class:r[2]},r[3]],i={};for(let o=0;o<n.length;o+=1)i=R(i,n[o]);return{c(){e=O("input"),this.h()},l(o){e=$(o,"INPUT",{type:!0,class:!0}),this.h()},h(){X(e,i)},m(o,l){b(o,e,l),e.autofocus&&e.focus(),ue(e,r[0]),t||(s=re(e,"input",r[4]),t=!0)},p(o,l){X(e,i=de(n,[{type:"password"},{class:o[2]},l&8&&o[3]])),l&1&&e.value!==o[0]&&ue(e,o[0])},d(o){o&&f(e),t=!1,s()}}}function $t(r){let e;function t(i,o){return i[1]?Ot:Ct}let s=t(r),n=s(r);return{c(){n.c(),e=K()},l(i){n.l(i),e=K()},m(i,o){n.m(i,o),b(i,e,o)},p(i,[o]){s===(s=t(i))&&n?n.p(i,o):(n.d(1),n=s(i),n&&(n.c(),n.m(e.parentNode,e)))},i:E,o:E,d(i){i&&f(e),n.d(i)}}}function Pt(r,e,t){const s=["password","value"];let n=ne(e,s),{password:i=!1}=e,{value:o=""}=e;const l=`
		px-2
		py-1
		rounded-2xl
		border-4
		text-slate-100
		border-cyan-500
		dark:text-slate-800
		hover:border-cyan-600
		active:border-cyan-700
		disabled:bg-cyan-200
		disabled:text-cyan-700
		disabled:border-cyan-300
	`;function a(){o=this.value,t(0,o)}function c(){o=this.value,t(0,o)}return r.$$set=u=>{e=R(R({},e),H(u)),t(3,n=ne(e,s)),"password"in u&&t(1,i=u.password),"value"in u&&t(0,o=u.value)},[o,i,l,n,a,c]}class Ee extends Q{constructor(e){super(),Y(this,e,Pt,$t,J,{password:1,value:0})}}function C(r,e,t,s){return new(t||(t=Promise))(function(n,i){function o(c){try{a(s.next(c))}catch(u){i(u)}}function l(c){try{a(s.throw(c))}catch(u){i(u)}}function a(c){c.done?n(c.value):function(h){return h instanceof t?h:new t(function(_){_(h)})}(c.value).then(o,l)}a((s=s.apply(r,e||[])).next())})}class W extends Error{constructor(e){var t,s,n,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,W.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof W||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)===null||t===void 0?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":!((i=(n=(s=this.originalError)===null||s===void 0?void 0:s.cause)===null||n===void 0?void 0:n.message)===null||i===void 0)&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return Object.assign({},this)}}const ae=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Tt(r,e){const t={};if(typeof r!="string")return t;const s=Object.assign({},e||{}).decode||It;let n=0;for(;n<r.length;){const i=r.indexOf("=",n);if(i===-1)break;let o=r.indexOf(";",n);if(o===-1)o=r.length;else if(o<i){n=r.lastIndexOf(";",i-1)+1;continue}const l=r.slice(n,i).trim();if(t[l]===void 0){let a=r.slice(i+1,o).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[l]=s(a)}catch{t[l]=a}}n=o+1}return t}function Re(r,e,t){const s=Object.assign({},t||{}),n=s.encode||Et;if(!ae.test(r))throw new TypeError("argument name is invalid");const i=n(e);if(i&&!ae.test(i))throw new TypeError("argument val is invalid");let o=r+"="+i;if(s.maxAge!=null){const l=s.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(l)}if(s.domain){if(!ae.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!ae.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(s.expires)||isNaN(s.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.priority)switch(typeof s.priority=="string"?s.priority.toLowerCase():s.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function It(r){return r.indexOf("%")!==-1?decodeURIComponent(r):r}function Et(r){return encodeURIComponent(r)}let We;function ce(r){if(r)try{const e=decodeURIComponent(We(r.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Be(r,e=0){let t=ce(r);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}We=typeof atob=="function"?atob:r=>{let e=String(r).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,s,n=0,i=0,o="";s=e.charAt(i++);~s&&(t=n%4?64*t+s:s,n++%4)?o+=String.fromCharCode(255&t>>(-2*n&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return o};const Ae="pb_auth";class Rt{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Be(this.token)}get isAdmin(){return ce(this.token).type==="admin"}get isAuthRecord(){return ce(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Ae){const s=Tt(e||"")[t]||"";let n={};try{n=JSON.parse(s),(typeof n===null||typeof n!="object"||Array.isArray(n))&&(n={})}catch{}this.save(n.token||"",n.model||null)}exportToCookie(e,t=Ae){var s,n;const i={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},o=ce(this.token);o!=null&&o.exp?i.expires=new Date(1e3*o.exp):i.expires=new Date("1970-01-01"),e=Object.assign({},i,e);const l={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let a=Re(t,JSON.stringify(l),e);const c=typeof Blob<"u"?new Blob([a]).size:a.length;if(l.model&&c>4096){l.model={id:(s=l==null?void 0:l.model)===null||s===void 0?void 0:s.id,email:(n=l==null?void 0:l.model)===null||n===void 0?void 0:n.email};const u=["collectionId","username","verified"];for(const h in this.model)u.includes(h)&&(l.model[h]=this.model[h]);a=Re(t,JSON.stringify(l),e)}return a}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let s=this._onChangeCallbacks.length-1;s>=0;s--)if(this._onChangeCallbacks[s]==e)return delete this._onChangeCallbacks[s],void this._onChangeCallbacks.splice(s,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class At extends Rt{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let s=t;typeof t!="string"&&(s=JSON.stringify(t)),window.localStorage.setItem(e,s)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)===null||t===void 0||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class se{constructor(e){this.client=e}}class jt extends se{getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}testEmail(e,t,s){return s=Object.assign({method:"POST",body:{email:e,template:t}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}generateAppleClientSecret(e,t,s,n,i,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:s,privateKey:n,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}class ve extends se{decode(e){return e}getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let s=500;return(t=Object.assign({},e,t)).batch&&(s=t.batch,delete t.batch),this._getFullList(s,t)}getList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send(this.baseCrudPath,s).then(n=>{var i;return n.items=((i=n.items)===null||i===void 0?void 0:i.map(o=>this.decode(o)))||[],n})}getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(s=>{var n;if(!(!((n=s==null?void 0:s.items)===null||n===void 0)&&n.length))throw new W({status:404,data:{code:404,message:"The requested resource wasn't found.",data:{}}});return s.items[0]})}getOne(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(s=>this.decode(s))}create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(s=>this.decode(s))}update(e,t,s){return s=Object.assign({method:"PATCH",body:t},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),s).then(n=>this.decode(n))}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let s=[],n=i=>C(this,void 0,void 0,function*(){return this.getList(i,e||500,t).then(o=>{const l=o.items;return s=s.concat(l),l.length==o.perPage?n(i+1):s})});return n(1)}}function A(r,e,t,s){const n=s!==void 0;return n||t!==void 0?n?(console.warn(r),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,s),e):Object.assign(e,t):e}function fe(r){var e,t;(t=(e=r)._resetAutoRefresh)===null||t===void 0||t.call(e)}class qt extends ve{get baseCrudPath(){return"/api/admins"}update(e,t,s){return super.update(e,t,s).then(n=>{var i,o;return((i=this.client.authStore.model)===null||i===void 0?void 0:i.id)===n.id&&((o=this.client.authStore.model)===null||o===void 0?void 0:o.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,n),n})}delete(e,t){return super.delete(e,t).then(s=>{var n,i;return s&&((n=this.client.authStore.model)===null||n===void 0?void 0:n.id)===e&&((i=this.client.authStore.model)===null||i===void 0?void 0:i.collectionId)===void 0&&this.client.authStore.clear(),s})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}authWithPassword(e,t,s,n){return C(this,void 0,void 0,function*(){let i={method:"POST",body:{identity:e,password:t}};i=A("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",i,s,n);const o=i.autoRefreshThreshold;delete i.autoRefreshThreshold,i.autoRefresh||fe(this.client);let l=yield this.client.send(this.baseCrudPath+"/auth-with-password",i);return l=this.authResponse(l),o&&function(c,u,h,_){fe(c);const m=c.beforeSend,d=c.authStore.model,w=c.authStore.onChange((S,k)=>{(!S||(k==null?void 0:k.id)!=(d==null?void 0:d.id)||(k!=null&&k.collectionId||d!=null&&d.collectionId)&&(k==null?void 0:k.collectionId)!=(d==null?void 0:d.collectionId))&&fe(c)});c._resetAutoRefresh=function(){w(),c.beforeSend=m,delete c._resetAutoRefresh},c.beforeSend=(S,k)=>C(this,void 0,void 0,function*(){var B;const v=c.authStore.token;if(!((B=k.query)===null||B===void 0)&&B.autoRefresh)return m?m(S,k):{url:S,sendOptions:k};let P=c.authStore.isValid;if(P&&Be(c.authStore.token,u))try{yield h()}catch{P=!1}P||(yield _());const I=k.headers||{};for(let te in I)if(te.toLowerCase()=="authorization"&&v==I[te]&&c.authStore.token){I[te]=c.authStore.token;break}return k.headers=I,m?m(S,k):{url:S,sendOptions:k}})}(this.client,o,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},i))),l})}authRefresh(e,t){let s={method:"POST"};return s=A("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",s).then(this.authResponse.bind(this))}requestPasswordReset(e,t,s){let n={method:"POST",body:{email:e}};return n=A("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,t,s),this.client.send(this.baseCrudPath+"/request-password-reset",n).then(()=>!0)}confirmPasswordReset(e,t,s,n,i){let o={method:"POST",body:{token:e,password:t,passwordConfirm:s}};return o=A("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",o,n,i),this.client.send(this.baseCrudPath+"/confirm-password-reset",o).then(()=>!0)}}class Ve extends se{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentTopics=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}subscribe(e,t){var s;return C(this,void 0,void 0,function*(){if(!e)throw new Error("topic must be set.");const n=function(i){const o=i;let l;try{l=JSON.parse(o==null?void 0:o.data)}catch{}t(l||{})};return this.subscriptions[e]||(this.subscriptions[e]=[]),this.subscriptions[e].push(n),this.isConnected?this.subscriptions[e].length===1?yield this.submitSubscriptions():(s=this.eventSource)===null||s===void 0||s.addEventListener(e,n):yield this.connect(),()=>C(this,void 0,void 0,function*(){return this.unsubscribeByTopicAndListener(e,n)})})}unsubscribe(e){var t;return C(this,void 0,void 0,function*(){if(this.hasSubscriptionListeners(e)){if(e){for(let s of this.subscriptions[e])(t=this.eventSource)===null||t===void 0||t.removeEventListener(e,s);delete this.subscriptions[e]}else this.subscriptions={};this.hasSubscriptionListeners()?this.hasSubscriptionListeners(e)||(yield this.submitSubscriptions()):this.disconnect()}})}unsubscribeByPrefix(e){var t;return C(this,void 0,void 0,function*(){let s=!1;for(let n in this.subscriptions)if(n.startsWith(e)){s=!0;for(let i of this.subscriptions[n])(t=this.eventSource)===null||t===void 0||t.removeEventListener(n,i);delete this.subscriptions[n]}s&&(this.hasSubscriptionListeners()?yield this.submitSubscriptions():this.disconnect())})}unsubscribeByTopicAndListener(e,t){var s;return C(this,void 0,void 0,function*(){if(!Array.isArray(this.subscriptions[e])||!this.subscriptions[e].length)return;let n=!1;for(let i=this.subscriptions[e].length-1;i>=0;i--)this.subscriptions[e][i]===t&&(n=!0,delete this.subscriptions[e][i],this.subscriptions[e].splice(i,1),(s=this.eventSource)===null||s===void 0||s.removeEventListener(e,t));n&&(this.subscriptions[e].length||delete this.subscriptions[e],this.hasSubscriptionListeners()?this.hasSubscriptionListeners(e)||(yield this.submitSubscriptions()):this.disconnect())})}hasSubscriptionListeners(e){var t,s;if(this.subscriptions=this.subscriptions||{},e)return!!(!((t=this.subscriptions[e])===null||t===void 0)&&t.length);for(let n in this.subscriptions)if(!((s=this.subscriptions[n])===null||s===void 0)&&s.length)return!0;return!1}submitSubscriptions(){return C(this,void 0,void 0,function*(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentTopics=this.getNonEmptySubscriptionTopics(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentTopics},query:{requestKey:this.getSubscriptionsCancelKey()}}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getNonEmptySubscriptionTopics(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}connect(){return C(this,void 0,void 0,function*(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(()=>C(this,void 0,void 0,function*(){let s=3;for(;this.hasUnsentSubscriptions()&&s>0;)s--,yield this.submitSubscriptions()})).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId)}).catch(s=>{this.clientId="",this.connectErrorHandler(s)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionTopics();if(e.length!=this.lastSentTopics.length)return!0;for(const t of e)if(!this.lastSentTopics.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let s of this.pendingConnects)s.reject(new W(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)===null||t===void 0||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[]}}}class Lt extends ve{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}subscribeOne(e,t){return C(this,void 0,void 0,function*(){return console.warn("PocketBase: subscribeOne(recordId, callback) is deprecated. Please replace it with subscribe(recordId, callback)."),this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t)})}subscribe(e,t){return C(this,void 0,void 0,function*(){if(typeof e=="function")return console.warn("PocketBase: subscribe(callback) is deprecated. Please replace it with subscribe('*', callback)."),this.client.realtime.subscribe(this.collectionIdOrName,e);if(!t)throw new Error("Missing subscription callback.");if(e==="")throw new Error("Missing topic.");let s=this.collectionIdOrName;return e!=="*"&&(s+="/"+e),this.client.realtime.subscribe(s,t)})}unsubscribe(e){return C(this,void 0,void 0,function*(){return e==="*"?this.client.realtime.unsubscribe(this.collectionIdOrName):e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)})}getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const s=Object.assign({},e,t);return super.getFullList(s)}getList(e=1,t=30,s){return super.getList(e,t,s)}getFirstListItem(e,t){return super.getFirstListItem(e,t)}getOne(e,t){return super.getOne(e,t)}create(e,t){return super.create(e,t)}update(e,t,s){return super.update(e,t,s).then(n=>{var i,o,l;return((i=this.client.authStore.model)===null||i===void 0?void 0:i.id)!==(n==null?void 0:n.id)||((o=this.client.authStore.model)===null||o===void 0?void 0:o.collectionId)!==this.collectionIdOrName&&((l=this.client.authStore.model)===null||l===void 0?void 0:l.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,n),n})}delete(e,t){return super.delete(e,t).then(s=>{var n,i,o;return!s||((n=this.client.authStore.model)===null||n===void 0?void 0:n.id)!==e||((i=this.client.authStore.model)===null||i===void 0?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.model)===null||o===void 0?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),s})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}authWithPassword(e,t,s,n){let i={method:"POST",body:{identity:e,password:t}};return i=A("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",i,s,n),this.client.send(this.baseCollectionPath+"/auth-with-password",i).then(o=>this.authResponse(o))}authWithOAuth2Code(e,t,s,n,i,o,l){let a={method:"POST",body:{provider:e,code:t,codeVerifier:s,redirectUrl:n,createData:i}};return a=A("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",a,o,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(c=>this.authResponse(c))}authWithOAuth2(...e){return C(this,void 0,void 0,function*(){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},s=(yield this.listAuthMethods()).authProviders.find(a=>a.name===t.provider);if(!s)throw new W(new Error(`Missing or invalid provider "${t.provider}".`));const n=this.client.buildUrl("/api/oauth2-redirect"),i=new Ve(this.client);let o=null;function l(){o==null||o.close(),i.unsubscribe()}return t.urlCallback||(o=je(void 0)),new Promise((a,c)=>C(this,void 0,void 0,function*(){var u;try{yield i.subscribe("@oauth2",d=>C(this,void 0,void 0,function*(){const w=i.clientId;try{if(!d.state||w!==d.state)throw new Error("State parameters don't match.");const S=Object.assign({},t);delete S.provider,delete S.scopes,delete S.createData,delete S.urlCallback;const k=yield this.authWithOAuth2Code(s.name,d.code,s.codeVerifier,n,t.createData,S);a(k)}catch(S){c(new W(S))}l()}));const h={state:i.clientId};!((u=t.scopes)===null||u===void 0)&&u.length&&(h.scope=t.scopes.join(" "));const _=this._replaceQueryParams(s.authUrl+n,h);yield(t.urlCallback||function(d){o?o.location.href=d:o=je(d)})(_)}catch(h){l(),c(new W(h))}}))})}authRefresh(e,t){let s={method:"POST"};return s=A("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",s).then(n=>this.authResponse(n))}requestPasswordReset(e,t,s){let n={method:"POST",body:{email:e}};return n=A("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-password-reset",n).then(()=>!0)}confirmPasswordReset(e,t,s,n,i){let o={method:"POST",body:{token:e,password:t,passwordConfirm:s}};return o=A("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}requestVerification(e,t,s){let n={method:"POST",body:{email:e}};return n=A("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-verification",n).then(()=>!0)}confirmVerification(e,t,s){let n={method:"POST",body:{token:e}};return n=A("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/confirm-verification",n).then(()=>!0)}requestEmailChange(e,t,s){let n={method:"POST",body:{newEmail:e}};return n=A("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-email-change",n).then(()=>!0)}confirmEmailChange(e,t,s,n){let i={method:"POST",body:{token:e,password:t}};return i=A("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,s,n),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>!0)}listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}unlinkExternalAuth(e,t,s){return s=Object.assign({method:"DELETE"},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),s).then(()=>!0)}_replaceQueryParams(e,t={}){let s=e,n="";e.indexOf("?")>=0&&(s=e.substring(0,e.indexOf("?")),n=e.substring(e.indexOf("?")+1));const i={},o=n.split("&");for(const l of o){if(l=="")continue;const a=l.split("=");i[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let l in t)t.hasOwnProperty(l)&&(t[l]==null?delete i[l]:i[l]=t[l]);n="";for(let l in i)i.hasOwnProperty(l)&&(n!=""&&(n+="&"),n+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(i[l].replace(/%20/g,"+")));return n!=""?s+"?"+n:s}}function je(r){if(typeof window>"u"||!(window!=null&&window.open))throw new W(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,s=window.innerWidth,n=window.innerHeight;e=e>s?s:e,t=t>n?n:t;let i=s/2-e/2,o=n/2-t/2;return window.open(r,"popup_window","width="+e+",height="+t+",top="+o+",left="+i+",resizable,menubar=no")}class Ut extends ve{get baseCrudPath(){return"/api/collections"}import(e,t=!1,s){return C(this,void 0,void 0,function*(){return s=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},s),this.client.send(this.baseCrudPath+"/import",s).then(()=>!0)})}}class Nt extends se{getRequestsList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send("/api/logs/requests",s)}getRequest(e,t){return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/requests/"+encodeURIComponent(e),t)}getRequestsStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/requests/stats",e)}}class Dt extends se{check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Ft extends se{getUrl(e,t,s={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const n=[];n.push("api"),n.push("files"),n.push(encodeURIComponent(e.collectionId||e.collectionName)),n.push(encodeURIComponent(e.id)),n.push(encodeURIComponent(t));let i=this.client.buildUrl(n.join("/"));if(Object.keys(s).length){s.download===!1&&delete s.download;const o=new URLSearchParams(s);i+=(i.includes("?")?"&":"?")+o}return i}getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class Kt extends se{getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}const Wt=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];class Bt{constructor(e="/",t,s="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=s,this.authStore=t||new At,this.admins=new qt(this),this.collections=new Ut(this),this.files=new Ft(this),this.logs=new Nt(this),this.settings=new jt(this),this.realtime=new Ve(this),this.health=new Dt(this),this.backups=new Kt(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Lt(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}getFileUrl(e,t,s={}){return this.files.getUrl(e,t,s)}buildUrl(e){var t;let s=this.baseUrl;return typeof window>"u"||!window.location||s.startsWith("https://")||s.startsWith("http://")||(s=!((t=window.location.origin)===null||t===void 0)&&t.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(s+=window.location.pathname||"/",s+=s.endsWith("/")?"":"/"),s+=this.baseUrl),e&&(s+=s.endsWith("/")?"":"/",s+=e.startsWith("/")?e.substring(1):e),s}send(e,t){return C(this,void 0,void 0,function*(){t=this.initSendOptions(e,t);let s=this.buildUrl(e);if(this.beforeSend){const n=Object.assign({},yield this.beforeSend(s,t));n.url!==void 0||n.options!==void 0?(s=n.url||s,t=n.options||t):Object.keys(n).length&&(t=n,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const n=this.serializeQueryParams(t.query);n&&(s+=(s.includes("?")?"&":"?")+n),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(s,t).then(n=>C(this,void 0,void 0,function*(){let i={};try{i=yield n.json()}catch{}if(this.afterSend&&(i=yield this.afterSend(n,i)),n.status>=400)throw new W({url:n.url,status:n.status,data:i});return i})).catch(n=>{throw new W(n)})})}initSendOptions(e,t){(t=Object.assign({method:"GET"},t)).query=t.query||{},t.body=this.convertToFormDataIfNeeded(t.body);for(let s in t)Wt.includes(s)||(t.query[s]=t[s],delete t[s]);if(t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const s=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(s);const n=new AbortController;this.cancelControllers[s]=n,t.signal=n.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(let s in e){const n=Array.isArray(e[s])?e[s]:[e[s]];for(let i of n)t.append(s,i)}return t}hasBlobField(e){for(let t in e){const s=Array.isArray(e[t])?e[t]:[e[t]];for(let n of s)if(typeof Blob<"u"&&n instanceof Blob||typeof File<"u"&&n instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let s in e)if(s.toLowerCase()==t)return e[s];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const s in e){if(e[s]===null)continue;const n=e[s],i=encodeURIComponent(s);if(Array.isArray(n))for(const o of n)t.push(i+"="+encodeURIComponent(o));else n instanceof Date?t.push(i+"="+encodeURIComponent(n.toISOString())):typeof n!==null&&typeof n=="object"?t.push(i+"="+encodeURIComponent(JSON.stringify(n))):t.push(i+"="+encodeURIComponent(n))}return t.join("&")}}const V=new Bt(window.location.origin),Ge=et(V.authStore.model);V.authStore.onChange((r,e)=>{Ge.set(e)});function Vt(r){let e;return{c(){e=Z("Login")},l(t){e=ee(t,"Login")},m(t,s){b(t,e,s)},d(t){t&&f(e)}}}function Gt(r){let e,t,s,n,i,o,l,a,c,u,h,_,m,d;function w(v){r[4](v)}let S={placeholder:"E-mail address..."};r[0]!==void 0&&(S.value=r[0]),i=new Ee({props:S}),pe.push(()=>ye(i,"value",w));function k(v){r[5](v)}let B={password:!0,placeholder:"Password..."};return r[1]!==void 0&&(B.value=r[1]),a=new Ee({props:B}),pe.push(()=>ye(a,"value",k)),h=new ge({props:{type:"submit",disabled:!r[0]||!r[1],$$slots:{default:[Vt]},$$scope:{ctx:r}}}),{c(){e=O("div"),t=Z(r[2]),s=D(),n=O("form"),j(i.$$.fragment),l=D(),j(a.$$.fragment),u=D(),j(h.$$.fragment),this.h()},l(v){e=$(v,"DIV",{class:!0});var P=T(e);t=ee(P,r[2]),P.forEach(f),s=F(v),n=$(v,"FORM",{class:!0});var I=T(n);q(i.$$.fragment,I),l=F(I),q(a.$$.fragment,I),u=F(I),q(h.$$.fragment,I),I.forEach(f),this.h()},h(){y(e,"class","text-red-500"),_e(e,"invisible",!r[2]),y(n,"class","flex flex-col items-end gap-4")},m(v,P){b(v,e,P),N(e,t),b(v,s,P),b(v,n,P),L(i,n,null),N(n,l),L(a,n,null),N(n,u),L(h,n,null),_=!0,m||(d=re(n,"submit",Qe(r[3])),m=!0)},p(v,P){(!_||P&4)&&be(t,v[2]),(!_||P&4)&&_e(e,"invisible",!v[2]);const I={};!o&&P&1&&(o=!0,I.value=v[0],we(()=>o=!1)),i.$set(I);const te={};!c&&P&2&&(c=!0,te.value=v[1],we(()=>c=!1)),a.$set(te);const he={};P&3&&(he.disabled=!v[0]||!v[1]),P&64&&(he.$$scope={dirty:P,ctx:v}),h.$set(he)},i(v){_||(p(i.$$.fragment,v),p(a.$$.fragment,v),p(h.$$.fragment,v),_=!0)},o(v){g(i.$$.fragment,v),g(a.$$.fragment,v),g(h.$$.fragment,v),_=!1},d(v){v&&(f(e),f(s),f(n)),U(i),U(a),U(h),m=!1,d()}}}function Mt(r){let e,t;return e=new Fe({props:{$$slots:{default:[Gt]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,n){L(e,s,n),t=!0},p(s,[n]){const i={};n&71&&(i.$$scope={dirty:n,ctx:s}),e.$set(i)},i(s){t||(p(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){U(e,s)}}}function xt(r,e,t){let s="",n="",i=null;async function o(){try{await V.collection("users").authWithPassword(s,n)}catch(c){console.error(c),t(2,i="Incorrect login information.");return}}function l(c){s=c,t(0,s)}function a(c){n=c,t(1,n)}return[s,n,i,o,l,a]}class zt extends Q{constructor(e){super(),Y(this,e,xt,Mt,J,{})}}function qe(r,e,t){const s=r.slice();return s[11]=e[t],s}function Ht(r){let e,t;return{c(){e=O("img"),this.h()},l(s){e=$(s,"IMG",{src:!0,alt:!0}),this.h()},h(){me(e.src,t=tt+"/favicon.png")||y(e,"src",t),y(e,"alt","PocketSafe")},m(s,n){b(s,e,n)},p:E,d(s){s&&f(e)}}}function Le(r){let e,t,s,n,i,o;return e=new ge({props:{$$slots:{default:[Jt]},$$scope:{ctx:r}}}),e.$on("click",r[6]),{c(){j(e.$$.fragment),t=D(),s=O("input"),this.h()},l(l){q(e.$$.fragment,l),t=F(l),s=$(l,"INPUT",{type:!0,class:!0}),this.h()},h(){y(s,"type","file"),y(s,"class","hidden")},m(l,a){L(e,l,a),b(l,t,a),b(l,s,a),r[7](s),n=!0,i||(o=re(s,"change",r[8]),i=!0)},p(l,a){const c={};a&16384&&(c.$$scope={dirty:a,ctx:l}),e.$set(c)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){l&&(f(t),f(s)),U(e,l),r[7](null),i=!1,o()}}}function Jt(r){let e;return{c(){e=Z("Upload")},l(t){e=ee(t,"Upload")},m(t,s){b(t,e,s)},d(t){t&&f(e)}}}function Qt(r){let e,t,s,n;e=new Ke({props:{class:"hover:opacity-50",href:"/",$$slots:{default:[Ht]},$$scope:{ctx:r}}});let i=r[1]&&Le(r);return{c(){j(e.$$.fragment),t=D(),i&&i.c(),s=K()},l(o){q(e.$$.fragment,o),t=F(o),i&&i.l(o),s=K()},m(o,l){L(e,o,l),b(o,t,l),i&&i.m(o,l),b(o,s,l),n=!0},p(o,l){const a={};l&16384&&(a.$$scope={dirty:l,ctx:o}),e.$set(a),o[1]?i?(i.p(o,l),l&2&&p(i,1)):(i=Le(o),i.c(),p(i,1),i.m(s.parentNode,s)):i&&(ie(),g(i,1,1,()=>{i=null}),oe())},i(o){n||(p(e.$$.fragment,o),p(i),n=!0)},o(o){g(e.$$.fragment,o),g(i),n=!1},d(o){o&&(f(t),f(s)),U(e,o),i&&i.d(o)}}}function Ue(r){let e,t=r[1].username+"",s,n,i,o;return i=new ge({props:{$$slots:{default:[Yt]},$$scope:{ctx:r}}}),i.$on("click",r[4]),{c(){e=O("div"),s=Z(t),n=D(),j(i.$$.fragment)},l(l){e=$(l,"DIV",{});var a=T(e);s=ee(a,t),a.forEach(f),n=F(l),q(i.$$.fragment,l)},m(l,a){b(l,e,a),N(e,s),b(l,n,a),L(i,l,a),o=!0},p(l,a){(!o||a&2)&&t!==(t=l[1].username+"")&&be(s,t);const c={};a&16384&&(c.$$scope={dirty:a,ctx:l}),i.$set(c)},i(l){o||(p(i.$$.fragment,l),o=!0)},o(l){g(i.$$.fragment,l),o=!1},d(l){l&&(f(e),f(n)),U(i,l)}}}function Yt(r){let e;return{c(){e=Z("Logout")},l(t){e=ee(t,"Logout")},m(t,s){b(t,e,s)},d(t){t&&f(e)}}}function Xt(r){let e,t,s=r[1]&&Ue(r);return{c(){s&&s.c(),e=K()},l(n){s&&s.l(n),e=K()},m(n,i){s&&s.m(n,i),b(n,e,i),t=!0},p(n,i){n[1]?s?(s.p(n,i),i&2&&p(s,1)):(s=Ue(n),s.c(),p(s,1),s.m(e.parentNode,e)):s&&(ie(),g(s,1,1,()=>{s=null}),oe())},i(n){t||(p(s),t=!0)},o(n){g(s),t=!1},d(n){n&&f(e),s&&s.d(n)}}}function Zt(r){let e,t;return e=new zt({}),{c(){j(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,n){L(e,s,n),t=!0},p:E,i(s){t||(p(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){U(e,s)}}}function es(r){let e,t,s,n={ctx:r,current:null,token:null,hasCatch:!1,pending:ls,then:ss,catch:ts,value:3,blocks:[,,,]};return ke(t=r[3],n),{c(){e=K(),n.block.c()},l(i){e=K(),n.block.l(i)},m(i,o){b(i,e,o),n.block.m(i,n.anchor=o),n.mount=()=>e.parentNode,n.anchor=e,s=!0},p(i,o){r=i,n.ctx=r,o&8&&t!==(t=r[3])&&ke(t,n)||st(n,r,o)},i(i){s||(p(n.block),s=!0)},o(i){for(let o=0;o<3;o+=1){const l=n.blocks[o];g(l)}s=!1},d(i){i&&f(e),n.block.d(i),n.token=null,n=null}}}function ts(r){return{c:E,l:E,m:E,p:E,i:E,o:E,d:E}}function ss(r){let e,t,s,n=r[3].totalItems==0&&Ne();return t=new wt({props:{$$slots:{default:[rs]},$$scope:{ctx:r}}}),{c(){n&&n.c(),e=D(),j(t.$$.fragment)},l(i){n&&n.l(i),e=F(i),q(t.$$.fragment,i)},m(i,o){n&&n.m(i,o),b(i,e,o),L(t,i,o),s=!0},p(i,o){i[3].totalItems==0?n||(n=Ne(),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null);const l={};o&16392&&(l.$$scope={dirty:o,ctx:i}),t.$set(l)},i(i){s||(p(t.$$.fragment,i),s=!0)},o(i){g(t.$$.fragment,i),s=!1},d(i){i&&f(e),n&&n.d(i),U(t,i)}}}function Ne(r){let e;return{c(){e=Z("No files.")},l(t){e=ee(t,"No files.")},m(t,s){b(t,e,s)},d(t){t&&f(e)}}}function ns(r){let e,t,s;return{c(){e=O("img"),this.h()},l(n){e=$(n,"IMG",{slot:!0,src:!0,alt:!0}),this.h()},h(){y(e,"slot","image"),me(e.src,t=r[5](r[11]))||y(e,"src",t),y(e,"alt",s=r[11].name)},m(n,i){b(n,e,i)},p(n,i){i&8&&!me(e.src,t=n[5](n[11]))&&y(e,"src",t),i&8&&s!==(s=n[11].name)&&y(e,"alt",s)},d(n){n&&f(e)}}}function is(r){let e,t=r[11].name+"",s;return{c(){e=O("div"),s=Z(t),this.h()},l(n){e=$(n,"DIV",{slot:!0});var i=T(e);s=ee(i,t),i.forEach(f),this.h()},h(){y(e,"slot","subtitle")},m(n,i){b(n,e,i),N(e,s)},p(n,i){i&8&&t!==(t=n[11].name+"")&&be(s,t)},d(n){n&&f(e)}}}function os(r){let e,t,s;return e=new gt({props:{size:"lg",$$slots:{subtitle:[is],image:[ns]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment),t=D()},l(n){q(e.$$.fragment,n),t=F(n)},m(n,i){L(e,n,i),b(n,t,i),s=!0},p(n,i){const o={};i&16392&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){s||(p(e.$$.fragment,n),s=!0)},o(n){g(e.$$.fragment,n),s=!1},d(n){n&&f(t),U(e,n)}}}function De(r){let e,t;return e=new Ke({props:{href:V.files.getUrl(r[11],r[11].file),$$slots:{default:[os]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,n){L(e,s,n),t=!0},p(s,n){const i={};n&8&&(i.href=V.files.getUrl(s[11],s[11].file)),n&16392&&(i.$$scope={dirty:n,ctx:s}),e.$set(i)},i(s){t||(p(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){U(e,s)}}}function rs(r){let e,t,s=Se(r[3].items),n=[];for(let o=0;o<s.length;o+=1)n[o]=De(qe(r,s,o));const i=o=>g(n[o],1,1,()=>{n[o]=null});return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=K()},l(o){for(let l=0;l<n.length;l+=1)n[l].l(o);e=K()},m(o,l){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(o,l);b(o,e,l),t=!0},p(o,l){if(l&40){s=Se(o[3].items);let a;for(a=0;a<s.length;a+=1){const c=qe(o,s,a);n[a]?(n[a].p(c,l),p(n[a],1)):(n[a]=De(c),n[a].c(),p(n[a],1),n[a].m(e.parentNode,e))}for(ie(),a=s.length;a<n.length;a+=1)i(a);oe()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)p(n[l]);t=!0}},o(o){n=n.filter(Boolean);for(let l=0;l<n.length;l+=1)g(n[l]);t=!1},d(o){o&&f(e),Xe(n,o)}}}function ls(r){let e;return{c(){e=Z("Loading...")},l(t){e=ee(t,"Loading...")},m(t,s){b(t,e,s)},p:E,i:E,o:E,d(t){t&&f(e)}}}function as(r){let e,t,s,n;const i=[es,Zt],o=[];function l(a,c){return a[1]?0:1}return e=l(r),t=o[e]=i[e](r),{c(){t.c(),s=K()},l(a){t.l(a),s=K()},m(a,c){o[e].m(a,c),b(a,s,c),n=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(ie(),g(o[u],1,1,()=>{o[u]=null}),oe(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),p(t,1),t.m(s.parentNode,s))},i(a){n||(p(t),n=!0)},o(a){g(t),n=!1},d(a){a&&f(s),o[e].d(a)}}}function cs(r){let e,t,s,n;return e=new at({props:{$$slots:{end:[Xt],start:[Qt]},$$scope:{ctx:r}}}),s=new Fe({props:{$$slots:{default:[as]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment),t=D(),j(s.$$.fragment)},l(i){q(e.$$.fragment,i),t=F(i),q(s.$$.fragment,i)},m(i,o){L(e,i,o),b(i,t,o),L(s,i,o),n=!0},p(i,[o]){const l={};o&16391&&(l.$$scope={dirty:o,ctx:i}),e.$set(l);const a={};o&16394&&(a.$$scope={dirty:o,ctx:i}),s.$set(a)},i(i){n||(p(e.$$.fragment,i),p(s.$$.fragment,i),n=!0)},o(i){g(e.$$.fragment,i),g(s.$$.fragment,i),n=!1},d(i){i&&f(t),U(e,i),U(s,i)}}}function us(r,e,t){let s;Ye(r,Ge,d=>t(1,s=d));let n=null,i=null,o=null;function l(d){V.authStore.clear()}function a(){t(3,n=V.collection("files").getList(1,30,{sort:"-created"}))}async function c(){let d=[];for(const w of o)d.push(V.collection("files").create({name:w.name,file:w,owner:s.id}));await Promise.all(d),t(0,o=null),await a()}function u(d){return V.files.getUrl(d,d.file,{thumb:"96x96f"})}const h=()=>i.click();function _(d){pe[d?"unshift":"push"](()=>{i=d,t(2,i)})}function m(){o=this.files,t(0,o)}return r.$$.update=()=>{r.$$.dirty&1&&o&&c(),r.$$.dirty&2&&s&&a()},[o,s,i,n,l,u,h,_,m]}class ps extends Q{constructor(e){super(),Y(this,e,us,cs,J,{})}}export{ps as component};
