import{P as Pe,Q as Ee,R as M,S as Ie,s as D,r as j,D as N,f as k,g as O,h as I,d as g,F as Q,i as T,A as pe,u as L,v as U,w as x,C as Y,E as X,T as Re,a as G,c as H,j as P,x as R,O as Ae,y as J,B as me,o as qe,e as oe,z as je,l as be,m as ge,n as Le,K as Ue}from"./scheduler.c073d8ea.js";import{g as te,t as C,c as se,a as w,S as F,i as K,b as ve,d as ye,m as we,e as Se}from"./index.12b87e20.js";import{k as xe,l as Ne,w as De}from"./singletons.dbd6ba8b.js";function St(o,e){const t=e.token={};function s(i,n,r,l){if(e.token!==t)return;e.resolved=l;let a=e.ctx;r!==void 0&&(a=a.slice(),a[r]=l);const u=i&&(e.current=i)(a);let c=!1;e.block&&(e.blocks?e.blocks.forEach((d,y)=>{y!==n&&d&&(te(),C(d,1,1,()=>{e.blocks[y]===d&&(e.blocks[y]=null)}),se())}):e.block.d(1),u.c(),w(u,1),u.m(e.mount(),e.anchor),c=!0),e.block=u,e.blocks&&(e.blocks[n]=u),c&&Ie()}if(Pe(o)){const i=Ee();if(o.then(n=>{M(i),s(e.then,1,e.value,n),M(null)},n=>{if(M(i),s(e.catch,2,e.error,n),M(null),!e.hasCatch)throw n}),e.current!==e.pending)return s(e.pending,0),!0}else{if(e.current!==e.then)return s(e.then,1,e.value,o),!0;e.resolved=o}}function Ct(o,e,t){const s=e.slice(),{resolved:i}=o;o.current===o.then&&(s[o.value]=i),o.current===o.catch&&(s[o.error]=i),o.block.p(s,t)}function Ce(o,e){const t={},s={},i={$$scope:1};let n=o.length;for(;n--;){const r=o[n],l=e[n];if(l){for(const a in r)a in l||(s[a]=1);for(const a in l)i[a]||(t[a]=l[a],i[a]=1);o[n]=l}else for(const a in r)i[a]=1}for(const r in s)r in t||(t[r]=void 0);return t}function Fe(o){let e,t,s,i,n;const r=o[4].default,l=j(r,o,o[3],null);let a=[{class:t="text-cyan-500 hover:text-cyan-600 active:text-cyan-700 transition-all "+o[1]},{href:o[0]},o[2]],u={};for(let c=0;c<a.length;c+=1)u=N(u,a[c]);return{c(){e=k("a"),l&&l.c(),this.h()},l(c){e=O(c,"A",{class:!0,href:!0});var d=I(e);l&&l.l(d),d.forEach(g),this.h()},h(){Q(e,u)},m(c,d){T(c,e,d),l&&l.m(e,null),s=!0,i||(n=pe(e,"click",o[5]),i=!0)},p(c,[d]){l&&l.p&&(!s||d&8)&&L(l,r,c,c[3],s?x(r,c[3],d,null):U(c[3]),null),Q(e,u=Ce(a,[(!s||d&2&&t!==(t="text-cyan-500 hover:text-cyan-600 active:text-cyan-700 transition-all "+c[1]))&&{class:t},(!s||d&1)&&{href:c[0]},d&4&&c[2]]))},i(c){s||(w(l,c),s=!0)},o(c){C(l,c),s=!1},d(c){c&&g(e),l&&l.d(c),i=!1,n()}}}function Ke(o,e,t){let s;const i=["href"];let n=Y(e,i),{$$slots:r={},$$scope:l}=e,{href:a=""}=e;function u(c){Re.call(this,o,c)}return o.$$set=c=>{t(6,e=N(N({},e),X(c))),t(2,n=Y(e,i)),"href"in c&&t(0,a=c.href),"$$scope"in c&&t(3,l=c.$$scope)},o.$$.update=()=>{t(1,s=e.class??"")},e=X(e),[a,s,n,l,r,u]}class We extends F{constructor(e){super(),K(this,e,Ke,Fe,D,{href:0})}}const Be=o=>({}),re=o=>({}),$e=o=>({}),le=o=>({}),Me=o=>({}),ae=o=>({});function ce(o){let e,t;return e=new We({props:{class:"hover:opacity-50 transition-all",href:"/",$$slots:{default:[Ve]},$$scope:{ctx:o}}}),{c(){ve(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,i){we(e,s,i),t=!0},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){Se(e,s)}}}function Ve(o){let e,t;return{c(){e=k("img"),this.h()},l(s){e=O(s,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){P(e,"class","max-h-8"),Ae(e.src,t=xe+"/favicon.png")||P(e,"src",t),P(e,"alt","PocketSafe")},m(s,i){T(s,e,i)},p:J,d(s){s&&g(e)}}}function Ge(o){let e,t,s,i,n,r,l,a,u=o[0]&&ce(o);const c=o[1].start,d=j(c,o,o[2],ae),y=o[1].middle,p=j(y,o,o[2],le),b=o[1].end,v=j(b,o,o[2],re);return{c(){e=k("div"),t=k("div"),u&&u.c(),s=G(),d&&d.c(),i=G(),n=k("div"),p&&p.c(),r=G(),l=k("div"),v&&v.c(),this.h()},l(h){e=O(h,"DIV",{class:!0});var f=I(e);t=O(f,"DIV",{class:!0});var E=I(t);u&&u.l(E),s=H(E),d&&d.l(E),E.forEach(g),i=H(f),n=O(f,"DIV",{class:!0});var W=I(n);p&&p.l(W),W.forEach(g),r=H(f),l=O(f,"DIV",{class:!0});var q=I(l);v&&v.l(q),q.forEach(g),f.forEach(g),this.h()},h(){P(t,"class","flex flex-row gap-2 items-center"),P(n,"class","flex flex-row gap-2 items-center"),P(l,"class","flex flex-row gap-2 items-center"),P(e,"class","min-h-8 p-2 flex flex-row justify-between outline outline-2 outline-slate-300 dark:outline-slate-700 ")},m(h,f){T(h,e,f),R(e,t),u&&u.m(t,null),R(t,s),d&&d.m(t,null),R(e,i),R(e,n),p&&p.m(n,null),R(e,r),R(e,l),v&&v.m(l,null),a=!0},p(h,[f]){h[0]?u?f&1&&w(u,1):(u=ce(h),u.c(),w(u,1),u.m(t,s)):u&&(te(),C(u,1,1,()=>{u=null}),se()),d&&d.p&&(!a||f&4)&&L(d,c,h,h[2],a?x(c,h[2],f,Me):U(h[2]),ae),p&&p.p&&(!a||f&4)&&L(p,y,h,h[2],a?x(y,h[2],f,$e):U(h[2]),le),v&&v.p&&(!a||f&4)&&L(v,b,h,h[2],a?x(b,h[2],f,Be):U(h[2]),re)},i(h){a||(w(u),w(d,h),w(p,h),w(v,h),a=!0)},o(h){C(u),C(d,h),C(p,h),C(v,h),a=!1},d(h){h&&g(e),u&&u.d(),d&&d.d(h),p&&p.d(h),v&&v.d(h)}}}function He(o,e,t){let{$$slots:s={},$$scope:i}=e,{logo:n=!0}=e;return o.$$set=r=>{"logo"in r&&t(0,n=r.logo),"$$scope"in r&&t(2,i=r.$$scope)},[n,s,i]}class _t extends F{constructor(e){super(),K(this,e,He,Ge,D,{logo:0})}}function Je(o){let e,t;const s=o[1].default,i=j(s,o,o[0],null);return{c(){e=k("div"),i&&i.c(),this.h()},l(n){e=O(n,"DIV",{class:!0});var r=I(e);i&&i.l(r),r.forEach(g),this.h()},h(){P(e,"class","flex flex-col grow justify-center items-center gap-2")},m(n,r){T(n,e,r),i&&i.m(e,null),t=!0},p(n,[r]){i&&i.p&&(!t||r&1)&&L(i,s,n,n[0],t?x(s,n[0],r,null):U(n[0]),null)},i(n){t||(w(i,n),t=!0)},o(n){C(i,n),t=!1},d(n){n&&g(e),i&&i.d(n)}}}function ze(o,e,t){let{$$slots:s={},$$scope:i}=e;return o.$$set=n=>{"$$scope"in n&&t(0,i=n.$$scope)},[i,s]}class kt extends F{constructor(e){super(),K(this,e,ze,Je,D,{})}}const _e=Ne("goto");function Qe(o){let e,t,s,i,n;const r=o[7].default,l=j(r,o,o[6],null);let a=[{class:t="px-2 border-4 rounded-2xl text-white transition-all "+o[1]+" "+o[0]},o[3]],u={};for(let c=0;c<a.length;c+=1)u=N(u,a[c]);return{c(){e=k("button"),l&&l.c(),this.h()},l(c){e=O(c,"BUTTON",{class:!0});var d=I(e);l&&l.l(d),d.forEach(g),this.h()},h(){Q(e,u)},m(c,d){T(c,e,d),l&&l.m(e,null),e.autofocus&&e.focus(),s=!0,i||(n=pe(e,"click",o[2]),i=!0)},p(c,[d]){l&&l.p&&(!s||d&64)&&L(l,r,c,c[6],s?x(r,c[6],d,null):U(c[6]),null),Q(e,u=Ce(a,[(!s||d&3&&t!==(t="px-2 border-4 rounded-2xl text-white transition-all "+c[1]+" "+c[0]))&&{class:t},d&8&&c[3]]))},i(c){s||(w(l,c),s=!0)},o(c){C(l,c),s=!1},d(c){c&&g(e),l&&l.d(c),i=!1,n()}}}function Ye(o,e,t){let s,i;const n=["href","secondary"];let r=Y(e,n),{$$slots:l={},$$scope:a}=e,{href:u=null}=e,{secondary:c=!1}=e;const d=me();async function y(p){d("click",p,{cancelable:!0})&&u&&await _e(u)}return o.$$set=p=>{t(9,e=N(N({},e),X(p))),t(3,r=Y(e,n)),"href"in p&&t(4,u=p.href),"secondary"in p&&t(5,c=p.secondary),"$$scope"in p&&t(6,a=p.$$scope)},o.$$.update=()=>{o.$$.dirty&32&&t(1,s=c?`
			bg-teal-500
			border-teal-400
			hover:bg-teal-600
			hover:border-teal-500
			active:bg-teal-700
			active:border-teal-600
			disabled:bg-teal-200
			disabled:text-teal-700
			disabled:border-teal-300
			`:`
			bg-cyan-500
			border-cyan-400
			hover:bg-cyan-600
			hover:border-cyan-500
			active:bg-cyan-700
			active:border-cyan-600
			disabled:bg-cyan-200
			disabled:text-cyan-700
			disabled:border-cyan-300
			`),t(0,i=e.class??"")},e=X(e),[i,s,y,r,u,c,a,l]}class Xe extends F{constructor(e){super(),K(this,e,Ye,Qe,D,{href:4,secondary:5})}}function m(o,e,t,s){return new(t||(t=Promise))(function(i,n){function r(u){try{a(s.next(u))}catch(c){n(c)}}function l(u){try{a(s.throw(u))}catch(c){n(c)}}function a(u){u.done?i(u.value):function(d){return d instanceof t?d:new t(function(y){y(d)})}(u.value).then(r,l)}a((s=s.apply(o,e||[])).next())})}class _ extends Error{constructor(e){var t,s,i,n;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,_.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof _||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)===null||t===void 0?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":!((n=(i=(s=this.originalError)===null||s===void 0?void 0:s.cause)===null||i===void 0?void 0:i.message)===null||n===void 0)&&n.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return Object.assign({},this)}}const V=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Ze(o,e){const t={};if(typeof o!="string")return t;const s=Object.assign({},e||{}).decode||et;let i=0;for(;i<o.length;){const n=o.indexOf("=",i);if(n===-1)break;let r=o.indexOf(";",i);if(r===-1)r=o.length;else if(r<n){i=o.lastIndexOf(";",n-1)+1;continue}const l=o.slice(i,n).trim();if(t[l]===void 0){let a=o.slice(n+1,r).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[l]=s(a)}catch{t[l]=a}}i=r+1}return t}function ue(o,e,t){const s=Object.assign({},t||{}),i=s.encode||tt;if(!V.test(o))throw new TypeError("argument name is invalid");const n=i(e);if(n&&!V.test(n))throw new TypeError("argument val is invalid");let r=o+"="+n;if(s.maxAge!=null){const l=s.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(l)}if(s.domain){if(!V.test(s.domain))throw new TypeError("option domain is invalid");r+="; Domain="+s.domain}if(s.path){if(!V.test(s.path))throw new TypeError("option path is invalid");r+="; Path="+s.path}if(s.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(s.expires)||isNaN(s.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(r+="; HttpOnly"),s.secure&&(r+="; Secure"),s.priority)switch(typeof s.priority=="string"?s.priority.toLowerCase():s.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function et(o){return o.indexOf("%")!==-1?decodeURIComponent(o):o}function tt(o){return encodeURIComponent(o)}let ke;function z(o){if(o)try{const e=decodeURIComponent(ke(o.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Oe(o,e=0){let t=z(o);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}ke=typeof atob=="function"?atob:o=>{let e=String(o).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,s,i=0,n=0,r="";s=e.charAt(n++);~s&&(t=i%4?64*t+s:s,i++%4)?r+=String.fromCharCode(255&t>>(-2*i&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return r};const de="pb_auth";class st{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Oe(this.token)}get isAdmin(){return z(this.token).type==="admin"}get isAuthRecord(){return z(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=de){const s=Ze(e||"")[t]||"";let i={};try{i=JSON.parse(s),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)}exportToCookie(e,t=de){var s,i;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},r=z(this.token);r!=null&&r.exp?n.expires=new Date(1e3*r.exp):n.expires=new Date("1970-01-01"),e=Object.assign({},n,e);const l={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let a=ue(t,JSON.stringify(l),e);const u=typeof Blob<"u"?new Blob([a]).size:a.length;if(l.model&&u>4096){l.model={id:(s=l==null?void 0:l.model)===null||s===void 0?void 0:s.id,email:(i=l==null?void 0:l.model)===null||i===void 0?void 0:i.email};const c=["collectionId","username","verified"];for(const d in this.model)c.includes(d)&&(l.model[d]=this.model[d]);a=ue(t,JSON.stringify(l),e)}return a}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let s=this._onChangeCallbacks.length-1;s>=0;s--)if(this._onChangeCallbacks[s]==e)return delete this._onChangeCallbacks[s],void this._onChangeCallbacks.splice(s,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class it extends st{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let s=t;typeof t!="string"&&(s=JSON.stringify(t)),window.localStorage.setItem(e,s)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)===null||t===void 0||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class A{constructor(e){this.client=e}}class nt extends A{getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}testEmail(e,t,s){return s=Object.assign({method:"POST",body:{email:e,template:t}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}generateAppleClientSecret(e,t,s,i,n,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:s,privateKey:i,duration:n}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}class ie extends A{decode(e){return e}getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let s=500;return(t=Object.assign({},e,t)).batch&&(s=t.batch,delete t.batch),this._getFullList(s,t)}getList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send(this.baseCrudPath,s).then(i=>{var n;return i.items=((n=i.items)===null||n===void 0?void 0:n.map(r=>this.decode(r)))||[],i})}getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(s=>{var i;if(!(!((i=s==null?void 0:s.items)===null||i===void 0)&&i.length))throw new _({status:404,data:{code:404,message:"The requested resource wasn't found.",data:{}}});return s.items[0]})}getOne(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(s=>this.decode(s))}create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(s=>this.decode(s))}update(e,t,s){return s=Object.assign({method:"PATCH",body:t},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),s).then(i=>this.decode(i))}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let s=[],i=n=>m(this,void 0,void 0,function*(){return this.getList(n,e||500,t).then(r=>{const l=r.items;return s=s.concat(l),l.length==r.perPage?i(n+1):s})});return i(1)}}function S(o,e,t,s){const i=s!==void 0;return i||t!==void 0?i?(console.warn(o),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,s),e):Object.assign(e,t):e}function ee(o){var e,t;(t=(e=o)._resetAutoRefresh)===null||t===void 0||t.call(e)}class ot extends ie{get baseCrudPath(){return"/api/admins"}update(e,t,s){return super.update(e,t,s).then(i=>{var n,r;return((n=this.client.authStore.model)===null||n===void 0?void 0:n.id)===i.id&&((r=this.client.authStore.model)===null||r===void 0?void 0:r.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,i),i})}delete(e,t){return super.delete(e,t).then(s=>{var i,n;return s&&((i=this.client.authStore.model)===null||i===void 0?void 0:i.id)===e&&((n=this.client.authStore.model)===null||n===void 0?void 0:n.collectionId)===void 0&&this.client.authStore.clear(),s})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}authWithPassword(e,t,s,i){return m(this,void 0,void 0,function*(){let n={method:"POST",body:{identity:e,password:t}};n=S("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",n,s,i);const r=n.autoRefreshThreshold;delete n.autoRefreshThreshold,n.autoRefresh||ee(this.client);let l=yield this.client.send(this.baseCrudPath+"/auth-with-password",n);return l=this.authResponse(l),r&&function(u,c,d,y){ee(u);const p=u.beforeSend,b=u.authStore.model,v=u.authStore.onChange((h,f)=>{(!h||(f==null?void 0:f.id)!=(b==null?void 0:b.id)||(f!=null&&f.collectionId||b!=null&&b.collectionId)&&(f==null?void 0:f.collectionId)!=(b==null?void 0:b.collectionId))&&ee(u)});u._resetAutoRefresh=function(){v(),u.beforeSend=p,delete u._resetAutoRefresh},u.beforeSend=(h,f)=>m(this,void 0,void 0,function*(){var E;const W=u.authStore.token;if(!((E=f.query)===null||E===void 0)&&E.autoRefresh)return p?p(h,f):{url:h,sendOptions:f};let q=u.authStore.isValid;if(q&&Oe(u.authStore.token,c))try{yield d()}catch{q=!1}q||(yield y());const B=f.headers||{};for(let $ in B)if($.toLowerCase()=="authorization"&&W==B[$]&&u.authStore.token){B[$]=u.authStore.token;break}return f.headers=B,p?p(h,f):{url:h,sendOptions:f}})}(this.client,r,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},n))),l})}authRefresh(e,t){let s={method:"POST"};return s=S("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",s).then(this.authResponse.bind(this))}requestPasswordReset(e,t,s){let i={method:"POST",body:{email:e}};return i=S("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,s),this.client.send(this.baseCrudPath+"/request-password-reset",i).then(()=>!0)}confirmPasswordReset(e,t,s,i,n){let r={method:"POST",body:{token:e,password:t,passwordConfirm:s}};return r=S("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",r,i,n),this.client.send(this.baseCrudPath+"/confirm-password-reset",r).then(()=>!0)}}class Te extends A{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentTopics=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}subscribe(e,t){var s;return m(this,void 0,void 0,function*(){if(!e)throw new Error("topic must be set.");const i=function(n){const r=n;let l;try{l=JSON.parse(r==null?void 0:r.data)}catch{}t(l||{})};return this.subscriptions[e]||(this.subscriptions[e]=[]),this.subscriptions[e].push(i),this.isConnected?this.subscriptions[e].length===1?yield this.submitSubscriptions():(s=this.eventSource)===null||s===void 0||s.addEventListener(e,i):yield this.connect(),()=>m(this,void 0,void 0,function*(){return this.unsubscribeByTopicAndListener(e,i)})})}unsubscribe(e){var t;return m(this,void 0,void 0,function*(){if(this.hasSubscriptionListeners(e)){if(e){for(let s of this.subscriptions[e])(t=this.eventSource)===null||t===void 0||t.removeEventListener(e,s);delete this.subscriptions[e]}else this.subscriptions={};this.hasSubscriptionListeners()?this.hasSubscriptionListeners(e)||(yield this.submitSubscriptions()):this.disconnect()}})}unsubscribeByPrefix(e){var t;return m(this,void 0,void 0,function*(){let s=!1;for(let i in this.subscriptions)if(i.startsWith(e)){s=!0;for(let n of this.subscriptions[i])(t=this.eventSource)===null||t===void 0||t.removeEventListener(i,n);delete this.subscriptions[i]}s&&(this.hasSubscriptionListeners()?yield this.submitSubscriptions():this.disconnect())})}unsubscribeByTopicAndListener(e,t){var s;return m(this,void 0,void 0,function*(){if(!Array.isArray(this.subscriptions[e])||!this.subscriptions[e].length)return;let i=!1;for(let n=this.subscriptions[e].length-1;n>=0;n--)this.subscriptions[e][n]===t&&(i=!0,delete this.subscriptions[e][n],this.subscriptions[e].splice(n,1),(s=this.eventSource)===null||s===void 0||s.removeEventListener(e,t));i&&(this.subscriptions[e].length||delete this.subscriptions[e],this.hasSubscriptionListeners()?this.hasSubscriptionListeners(e)||(yield this.submitSubscriptions()):this.disconnect())})}hasSubscriptionListeners(e){var t,s;if(this.subscriptions=this.subscriptions||{},e)return!!(!((t=this.subscriptions[e])===null||t===void 0)&&t.length);for(let i in this.subscriptions)if(!((s=this.subscriptions[i])===null||s===void 0)&&s.length)return!0;return!1}submitSubscriptions(){return m(this,void 0,void 0,function*(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentTopics=this.getNonEmptySubscriptionTopics(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentTopics},query:{requestKey:this.getSubscriptionsCancelKey()}}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getNonEmptySubscriptionTopics(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}connect(){return m(this,void 0,void 0,function*(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(()=>m(this,void 0,void 0,function*(){let s=3;for(;this.hasUnsentSubscriptions()&&s>0;)s--,yield this.submitSubscriptions()})).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId)}).catch(s=>{this.clientId="",this.connectErrorHandler(s)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionTopics();if(e.length!=this.lastSentTopics.length)return!0;for(const t of e)if(!this.lastSentTopics.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let s of this.pendingConnects)s.reject(new _(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)===null||t===void 0||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[]}}}class rt extends ie{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}subscribeOne(e,t){return m(this,void 0,void 0,function*(){return console.warn("PocketBase: subscribeOne(recordId, callback) is deprecated. Please replace it with subscribe(recordId, callback)."),this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t)})}subscribe(e,t){return m(this,void 0,void 0,function*(){if(typeof e=="function")return console.warn("PocketBase: subscribe(callback) is deprecated. Please replace it with subscribe('*', callback)."),this.client.realtime.subscribe(this.collectionIdOrName,e);if(!t)throw new Error("Missing subscription callback.");if(e==="")throw new Error("Missing topic.");let s=this.collectionIdOrName;return e!=="*"&&(s+="/"+e),this.client.realtime.subscribe(s,t)})}unsubscribe(e){return m(this,void 0,void 0,function*(){return e==="*"?this.client.realtime.unsubscribe(this.collectionIdOrName):e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)})}getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const s=Object.assign({},e,t);return super.getFullList(s)}getList(e=1,t=30,s){return super.getList(e,t,s)}getFirstListItem(e,t){return super.getFirstListItem(e,t)}getOne(e,t){return super.getOne(e,t)}create(e,t){return super.create(e,t)}update(e,t,s){return super.update(e,t,s).then(i=>{var n,r,l;return((n=this.client.authStore.model)===null||n===void 0?void 0:n.id)!==(i==null?void 0:i.id)||((r=this.client.authStore.model)===null||r===void 0?void 0:r.collectionId)!==this.collectionIdOrName&&((l=this.client.authStore.model)===null||l===void 0?void 0:l.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,i),i})}delete(e,t){return super.delete(e,t).then(s=>{var i,n,r;return!s||((i=this.client.authStore.model)===null||i===void 0?void 0:i.id)!==e||((n=this.client.authStore.model)===null||n===void 0?void 0:n.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.model)===null||r===void 0?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),s})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}authWithPassword(e,t,s,i){let n={method:"POST",body:{identity:e,password:t}};return n=S("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",n,s,i),this.client.send(this.baseCollectionPath+"/auth-with-password",n).then(r=>this.authResponse(r))}authWithOAuth2Code(e,t,s,i,n,r,l){let a={method:"POST",body:{provider:e,code:t,codeVerifier:s,redirectUrl:i,createData:n}};return a=S("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",a,r,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(u=>this.authResponse(u))}authWithOAuth2(...e){return m(this,void 0,void 0,function*(){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},s=(yield this.listAuthMethods()).authProviders.find(a=>a.name===t.provider);if(!s)throw new _(new Error(`Missing or invalid provider "${t.provider}".`));const i=this.client.buildUrl("/api/oauth2-redirect"),n=new Te(this.client);let r=null;function l(){r==null||r.close(),n.unsubscribe()}return t.urlCallback||(r=he(void 0)),new Promise((a,u)=>m(this,void 0,void 0,function*(){var c;try{yield n.subscribe("@oauth2",b=>m(this,void 0,void 0,function*(){const v=n.clientId;try{if(!b.state||v!==b.state)throw new Error("State parameters don't match.");const h=Object.assign({},t);delete h.provider,delete h.scopes,delete h.createData,delete h.urlCallback;const f=yield this.authWithOAuth2Code(s.name,b.code,s.codeVerifier,i,t.createData,h);a(f)}catch(h){u(new _(h))}l()}));const d={state:n.clientId};!((c=t.scopes)===null||c===void 0)&&c.length&&(d.scope=t.scopes.join(" "));const y=this._replaceQueryParams(s.authUrl+i,d);yield(t.urlCallback||function(b){r?r.location.href=b:r=he(b)})(y)}catch(d){l(),u(new _(d))}}))})}authRefresh(e,t){let s={method:"POST"};return s=S("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",s).then(i=>this.authResponse(i))}requestPasswordReset(e,t,s){let i={method:"POST",body:{email:e}};return i=S("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,s),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}confirmPasswordReset(e,t,s,i,n){let r={method:"POST",body:{token:e,password:t,passwordConfirm:s}};return r=S("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,i,n),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}requestVerification(e,t,s){let i={method:"POST",body:{email:e}};return i=S("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,s),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}confirmVerification(e,t,s){let i={method:"POST",body:{token:e}};return i=S("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,s),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>!0)}requestEmailChange(e,t,s){let i={method:"POST",body:{newEmail:e}};return i=S("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,s),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}confirmEmailChange(e,t,s,i){let n={method:"POST",body:{token:e,password:t}};return n=S("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",n,s,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",n).then(()=>!0)}listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}unlinkExternalAuth(e,t,s){return s=Object.assign({method:"DELETE"},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),s).then(()=>!0)}_replaceQueryParams(e,t={}){let s=e,i="";e.indexOf("?")>=0&&(s=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const n={},r=i.split("&");for(const l of r){if(l=="")continue;const a=l.split("=");n[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let l in t)t.hasOwnProperty(l)&&(t[l]==null?delete n[l]:n[l]=t[l]);i="";for(let l in n)n.hasOwnProperty(l)&&(i!=""&&(i+="&"),i+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(n[l].replace(/%20/g,"+")));return i!=""?s+"?"+i:s}}function he(o){if(typeof window>"u"||!(window!=null&&window.open))throw new _(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,s=window.innerWidth,i=window.innerHeight;e=e>s?s:e,t=t>i?i:t;let n=s/2-e/2,r=i/2-t/2;return window.open(o,"popup_window","width="+e+",height="+t+",top="+r+",left="+n+",resizable,menubar=no")}class lt extends ie{get baseCrudPath(){return"/api/collections"}import(e,t=!1,s){return m(this,void 0,void 0,function*(){return s=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},s),this.client.send(this.baseCrudPath+"/import",s).then(()=>!0)})}}class at extends A{getRequestsList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send("/api/logs/requests",s)}getRequest(e,t){return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/requests/"+encodeURIComponent(e),t)}getRequestsStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/requests/stats",e)}}class ct extends A{check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class ut extends A{getUrl(e,t,s={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let n=this.client.buildUrl(i.join("/"));if(Object.keys(s).length){s.download===!1&&delete s.download;const r=new URLSearchParams(s);n+=(n.includes("?")?"&":"?")+r}return n}getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class dt extends A{getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}const ht=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];class ft{constructor(e="/",t,s="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=s,this.authStore=t||new it,this.admins=new ot(this),this.collections=new lt(this),this.files=new ut(this),this.logs=new at(this),this.settings=new nt(this),this.realtime=new Te(this),this.health=new ct(this),this.backups=new dt(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new rt(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}getFileUrl(e,t,s={}){return this.files.getUrl(e,t,s)}buildUrl(e){var t;let s=this.baseUrl;return typeof window>"u"||!window.location||s.startsWith("https://")||s.startsWith("http://")||(s=!((t=window.location.origin)===null||t===void 0)&&t.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(s+=window.location.pathname||"/",s+=s.endsWith("/")?"":"/"),s+=this.baseUrl),e&&(s+=s.endsWith("/")?"":"/",s+=e.startsWith("/")?e.substring(1):e),s}send(e,t){return m(this,void 0,void 0,function*(){t=this.initSendOptions(e,t);let s=this.buildUrl(e);if(this.beforeSend){const i=Object.assign({},yield this.beforeSend(s,t));i.url!==void 0||i.options!==void 0?(s=i.url||s,t=i.options||t):Object.keys(i).length&&(t=i,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=this.serializeQueryParams(t.query);i&&(s+=(s.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(s,t).then(i=>m(this,void 0,void 0,function*(){let n={};try{n=yield i.json()}catch{}if(this.afterSend&&(n=yield this.afterSend(i,n)),i.status>=400)throw new _({url:i.url,status:i.status,data:n});return n})).catch(i=>{throw new _(i)})})}initSendOptions(e,t){(t=Object.assign({method:"GET"},t)).query=t.query||{},t.body=this.convertToFormDataIfNeeded(t.body);for(let s in t)ht.includes(s)||(t.query[s]=t[s],delete t[s]);if(t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const s=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(s);const i=new AbortController;this.cancelControllers[s]=i,t.signal=i.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(let s in e){const i=Array.isArray(e[s])?e[s]:[e[s]];for(let n of i)t.append(s,n)}return t}hasBlobField(e){for(let t in e){const s=Array.isArray(e[t])?e[t]:[e[t]];for(let i of s)if(typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let s in e)if(s.toLowerCase()==t)return e[s];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const s in e){if(e[s]===null)continue;const i=e[s],n=encodeURIComponent(s);if(Array.isArray(i))for(const r of i)t.push(n+"="+encodeURIComponent(r));else i instanceof Date?t.push(n+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(n+"="+encodeURIComponent(JSON.stringify(i))):t.push(n+"="+encodeURIComponent(i))}return t.join("&")}}const Z=new ft(window.location.origin),ne=De(Z.authStore.model);function Ot(){qe(()=>{const o=ne.subscribe(async e=>{e||await _e(`/login?redirect=${encodeURIComponent(window.location.href)}`)});return()=>{o()}})}function Tt(o){return Z.files.getUrl(o,o.file,{thumb:"96x96f"})}Z.authStore.onChange((o,e)=>{ne.set(e)});function fe(o){let e,t=o[1].username+"",s,i,n,r;return n=new Xe({props:{$$slots:{default:[pt]},$$scope:{ctx:o}}}),n.$on("click",o[0]),{c(){e=k("div"),s=be(t),i=G(),ve(n.$$.fragment)},l(l){e=O(l,"DIV",{});var a=I(e);s=ge(a,t),a.forEach(g),i=H(l),ye(n.$$.fragment,l)},m(l,a){T(l,e,a),R(e,s),T(l,i,a),we(n,l,a),r=!0},p(l,a){(!r||a&2)&&t!==(t=l[1].username+"")&&Le(s,t);const u={};a&8&&(u.$$scope={dirty:a,ctx:l}),n.$set(u)},i(l){r||(w(n.$$.fragment,l),r=!0)},o(l){C(n.$$.fragment,l),r=!1},d(l){l&&(g(e),g(i)),Se(n,l)}}}function pt(o){let e;return{c(){e=be("Logout")},l(t){e=ge(t,"Logout")},m(t,s){T(t,e,s)},d(t){t&&g(e)}}}function mt(o){let e,t,s=o[1]&&fe(o);return{c(){s&&s.c(),e=oe()},l(i){s&&s.l(i),e=oe()},m(i,n){s&&s.m(i,n),T(i,e,n),t=!0},p(i,[n]){i[1]?s?(s.p(i,n),n&2&&w(s,1)):(s=fe(i),s.c(),w(s,1),s.m(e.parentNode,e)):s&&(te(),C(s,1,1,()=>{s=null}),se())},i(i){t||(w(s),t=!0)},o(i){C(s),t=!1},d(i){i&&g(e),s&&s.d(i)}}}function bt(o,e,t){let s;je(o,ne,r=>t(1,s=r));const i=me();function n(r){i("logout",null,{cancelable:!0})&&Z.authStore.clear()}return[n,s]}class Pt extends F{constructor(e){super(),K(this,e,bt,mt,D,{logout:0})}get logout(){return this.$$.ctx[0]}}function gt(o){let e,t='<div class="w-full h-full rounded-full bg-slate-200 dark:bg-slate-800 "></div>';return{c(){e=k("div"),e.innerHTML=t,this.h()},l(s){e=O(s,"DIV",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-1vv7ujx"&&(e.innerHTML=t),this.h()},h(){P(e,"class","w-8 h-8 p-0.5 rounded-full animate-spin bg-gradient-to-r from-transparent via-transparent to-teal-500 ")},m(s,i){T(s,e,i)},p:J,i:J,o:J,d(s){s&&g(e)}}}class Et extends F{constructor(e){super(),K(this,e,null,gt,D,{})}}export{Xe as B,Et as C,We as L,_t as N,kt as a,Pt as b,ne as c,Ot as d,Ce as g,St as h,Z as p,Tt as t,Ct as u};
